import { useState } from "react";

type MenuItem = {
  id: number;
    name: string;
      price: number;
        category: string;
          bestSeller?: boolean;
          };

          const menu: MenuItem[] = [
            // Espresso Based
              { id: 1, name: "Espresso", price: 18000, category: "Espresso Based", bestSeller: true },
                { id: 2, name: "Americano", price: 20000, category: "Espresso Based" },
                  { id: 3, name: "Cappuccino", price: 25000, category: "Espresso Based", bestSeller: true },
                    { id: 4, name: "Caffè Latte", price: 25000, category: "Espresso Based" },
                      { id: 5, name: "Mocha", price: 28000, category: "Espresso Based" },
                        { id: 6, name: "Macchiato", price: 24000, category: "Espresso Based" },

                          // Non Coffee
                            { id: 7, name: "Matcha Latte", price: 28000, category: "Non Coffee" },
                              { id: 8, name: "Red Velvet Latte", price: 28000, category: "Non Coffee" },
                                { id: 9, name: "Chocolate", price: 25000, category: "Non Coffee" },
                                  { id: 10, name: "Vanilla Latte", price: 26000, category: "Non Coffee", bestSeller: true },

                                    // Manual Brew
                                      { id: 11, name: "V60", price: 28000, category: "Manual Brew" },
                                        { id: 12, name: "French Press", price: 30000, category: "Manual Brew" },
                                          { id: 13, name: "Aeropress", price: 30000, category: "Manual Brew" },

                                            // Snack
                                              { id: 14, name: "Croissant", price: 18000, category: "Snack" },
                                                { id: 15, name: "Donut Original", price: 15000, category: "Snack" },
                                                  { id: 16, name: "Donut Coklat", price: 16000, category: "Snack" },
                                                    { id: 17, name: "Donut Strawberry", price: 16000, category: "Snack" },
                                                      { id: 18, name: "French Fries", price: 22000, category: "Snack" },
                                                        { id: 19, name: "Chicken Wings Original", price: 35000, category: "Snack" },
                                                          { id: 20, name: "Chicken Wings BBQ", price: 37000, category: "Snack" },
                                                            { id: 21, name: "Chicken Katsu + Nasi", price: 45000, category: "Snack" },
                                                            ];

                                                            export default function App() {
                                                              const [orders, setOrders] = useState<MenuItem[]>([]);
                                                                const [confirmed, setConfirmed] = useState(false);
                                                                  const [loading, setLoading] = useState(false);
                                                                    const [table, setTable] = useState<number | "">("");

                                                                      const addToOrder = (item: MenuItem) => setOrders([...orders, item]);

                                                                        const confirmOrder = () => {
                                                                            if (orders.length === 0 || table === "") return;
                                                                                setLoading(true);
                                                                                    setConfirmed(false);
                                                                                        setTimeout(() => {
                                                                                              setLoading(false);
                                                                                                    setConfirmed(true);
                                                                                                          setOrders([]);
                                                                                                                // meja tetap dipilih
                                                                                                                    }, 800);
                                                                                                                      };

                                                                                                                        const groupedMenu = menu.reduce((acc, item) => {
                                                                                                                            (acc[item.category] = acc[item.category] || []).push(item);
                                                                                                                                return acc;
                                                                                                                                  }, {} as Record<string, MenuItem[]>);

                                                                                                                                    const bestSellers = menu.filter(item => item.bestSeller);

                                                                                                                                      return (
                                                                                                                                          <div style={{ fontFamily: "Arial, sans-serif", background: "#f8f5f2", minHeight: "100vh", display: "flex", flexDirection: "column" }}>
                                                                                                                                                <header style={{ background: "#6f4e37", color: "white", textAlign: "center", padding: "20px" }}>
                                                                                                                                                        <h1 style={{ fontSize: "28px", margin: 0 }}>☕ Ruang Kopi</h1>
                                                                                                                                                                <p style={{ margin: "5px 0 0" }}>Tempat hangat untuk cerita & secangkir kopi</p>
                                                                                                                                                                      </header>

                                                                                                                                                                            <main style={{ flex: 1, maxWidth: "900px", margin: "0 auto", padding: "20px" }}>
                                                                                                                                                                                    {/* Best Seller */}
                                                                                                                                                                                            {bestSellers.length > 0 && (
                                                                                                                                                                                                      <div style={{ marginBottom: "40px" }}>
                                                                                                                                                                                                                  <h2 style={{ fontSize: "22px", marginBottom: "15px", color: "#6f4e37", borderBottom: "2px solid gold", display: "inline-block" }}>
                                                                                                                                                                                                                                ✨ Best Seller
                                                                                                                                                                                                                                            </h2>
                                                                                                                                                                                                                                                        <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fill, minmax(250px, 1fr))", gap: "20px" }}>
                                                                                                                                                                                                                                                                      {bestSellers.map(item => (
                                                                                                                                                                                                                                                                                      <div key={item.id} style={{ background: "#fff8dc", borderRadius: "10px", padding: "15px", boxShadow: "0 2px 6px rgba(0,0,0,0.1)", position: "relative" }}>
                                                                                                                                                                                                                                                                                                        <span style={{ position: "absolute", top: "8px", right: "8px", background: "gold", color: "#6f4e37", padding: "2px 6px", borderRadius: "4px", fontWeight: "bold", fontSize: "12px" }}>
                                                                                                                                                                                                                                                                                                                            Best Seller
                                                                                                                                                                                                                                                                                                                                              </span>
                                                                                                                                                                                                                                                                                                                                                                <p style={{ fontWeight: "bold", fontSize: "16px", margin: "0 0 5px" }}>{item.name}</p>
                                                                                                                                                                                                                                                                                                                                                                                  <p style={{ color: "#6f4e37", fontWeight: "bold", margin: "0 0 10px" }}>Rp {item.price.toLocaleString("id-ID")}</p>
                                                                                                                                                                                                                                                                                                                                                                                                    <button onClick={() => addToOrder(item)} style={{ background: "#6f4e37", color: "white", border: "none", padding: "8px 12px", borderRadius: "6px", cursor: "pointer" }}>Pesan</button>
                                                                                                                                                                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                  ))}
                                                                                                                                                                                                                                                                                                                                                                                                                                              </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                )}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                        {/* Semua kategori */}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                {Object.keys(groupedMenu).map(category => (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <div key={category} style={{ marginBottom: "40px" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <h2 style={{ fontSize: "22px", marginBottom: "15px", color: "#6f4e37", borderBottom: "2px solid #6f4e37", display: "inline-block" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    {category}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </h2>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fill, minmax(250px, 1fr))", gap: "20px" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          {groupedMenu[category].map(item => (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <div key={item.id} style={{ background: "white", borderRadius: "10px", padding: "15px", boxShadow: "0 2px 6px rgba(0,0,0,0.1)", position: "relative" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            {item.bestSeller && (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <span style={{ position: "absolute", top: "8px", right: "8px", background: "gold", color: "#6f4e37", padding: "2px 6px", borderRadius: "4px", fontWeight: "bold", fontSize: "12px" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Best Seller
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            )}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <p style={{ fontWeight: "bold", fontSize: "16px", margin: "0 0 5px" }}>{item.name}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <p style={{ color: "#6f4e37", fontWeight: "bold", margin: "0 0 10px" }}>Rp {item.price.toLocaleString("id-ID")}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <button onClick={() => addToOrder(item)} style={{ background: "#6f4e37", color: "white", border: "none", padding: "8px 12px", borderRadius: "6px", cursor: "pointer" }}>Pesan</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ))}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ))}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      {/* Pesanan */}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <section style={{ background: "white", padding: "20px", borderRadius: "10px", boxShadow: "0 2px 6px rgba(0,0,0,0.1)" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <h2 style={{ fontSize: "20px", marginBottom: "15px", color: "#6f4e37" }}>Pesanan Saya</h2>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <div style={{ marginBottom: "15px" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <label htmlFor="tableSelect" style={{ marginRight: "10px", fontWeight: "bold" }}>Nomor Meja:</label>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <select id="tableSelect" value={table} onChange={(e) => setTable(Number(e.target.value))} style={{ padding: "5px 10px", borderRadius: "6px", border: "1px solid #ccc", cursor: "pointer" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <option value="">Pilih Meja</option>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      {Array.from({ length: 25 }, (_, i) => i + 1).map(num => (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <option key={num} value={num}>{num}</option>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ))}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </select>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </div>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    {orders.length === 0 ? (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <p style={{ color: "gray" }}>Belum ada pesanan.</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ) : (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <ul style={{ listStyle: "none", padding: 0, margin: 0 }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    {orders.map((order, index) => (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <li key={index} style={{ display: "flex", justifyContent: "space-between", borderBottom: "1px solid #eee", padding: "5px 0" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <span>{order.name}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <span>Rp {order.price.toLocaleString("id-ID")}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ))}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <p style={{ fontWeight: "bold", marginTop: "10px" }}>Total: Rp {orders.reduce((sum, item) => sum + item.price, 0).toLocaleString("id-ID")}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <button
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          onClick={confirmOrder}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          disabled={table === ""}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          style={{ marginTop: "15px", width: "100%", background: table === "" ? "#aaa" : "green", color: "white", padding: "10px", borderRadius: "6px", border: "none", cursor: table === "" ? "not-allowed" : "pointer" }}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        {loading ? "Loading..." : "Konfirmasi Pesanan"}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            )}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      {confirmed && (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <p style={{ color: "green", fontWeight: "bold", marginTop: "10px" }}>✅ Pesanan berhasil! (Meja: {table})</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            )}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </section>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </main>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <footer style={{ background: "#6f4e37", color: "white", textAlign: "center", padding: "20px", marginTop: "30px" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <p>© 2025 Ruang Kopi. Semua Hak Dilindungi.</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <p style={{ marginTop: "5px" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          📸 Instagram:{" "}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <a href="https://instagram.com/ruangkopi" target="_blank" rel="noopener noreferrer" style={{ color: "white", textDecoration: "underline" }}>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                @ruangkopi
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </footer>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              );
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }